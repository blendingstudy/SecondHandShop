{% extends 'base.html' %}

{% block content %}
  <h1>Chatroom for {{ chatroom.item.title }}</h1>
  <div id="message-list">
    {% for message in messages %}
      <div>
        <strong>{{ message.user.username }}</strong>: {{ message.text }}
        <span>{{ message.timestamp }}</span>
      </div>
    {% empty %}
      <p>No messages yet.</p>
    {% endfor %}
  </div>

  <form method="post" action="{% url 'chat:message_create' %}">
    {% csrf_token %}
    <input type="hidden" name="chatroom" value="{{ chatroom.id }}">
    <input type="text" name="text" placeholder="Type your message..." required>
    <button type="submit">Send</button>
  </form>

  {% if user == chatroom.item.owner %}
    <form id="transaction-form">
      <select name="status">
        <option value="initiated">Initiated</option>
        <option value="completed">Completed</option>
        <option value="cancelled">Cancelled</option>
      </select>
      <button type="submit">Update Transaction Status</button>
    </form>
  {% endif %}
{% endblock %}